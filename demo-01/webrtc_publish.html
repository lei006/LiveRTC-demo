<!DOCTYPE html>
<html id="home" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
		<script src="http://livertc.eyoujs.com/LivePeer.js"></script>
    </head>
    <body>
		<div style="width:400px; height:300px;">
			<video id="localVideo" style="width:100%; height:100%;object-fit: fill" autoplay muted></video>
		</div>
    </body>
	<script>
		let test_id = "I-is-test-id"
		async function video_push(){
			// 1.新建peer
			//let livePeer = new LivePeerJS(axios,{host_url:"demo.livertc.eyoujs.com:8088"})
			let livePeer = new LivePeerJS(axios,{host_url:"47.103.69.4:8088"})
			//let livePeer = new LivePeerJS(axios,{host_url:"127.0.0.1:8088"})
			
			// 2.登录Sfu上线
			let ret = await livePeer.login("123456")			
			navigator.mediaDevices.getUserMedia({ video: {width: { ideal: 640 },height: { ideal: 480 },facingMode: "user"}, audio: true }).then(async (stream) => {
			  document.getElementById('localVideo').srcObject = stream
			  // 3.把流推送到Sfu
			  await livePeer.publish_webrtc(test_id,"测试视频",stream )
			})
		}
		video_push();
		
		
		
	</script>
</html>